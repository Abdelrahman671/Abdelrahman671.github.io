<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="google-site-verification" content="L5cIPdrAmnjHT3rW1NC4Xje_ndvJ9A937q6S4yf6HCE" /><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Squirrel" /><meta name="author" content="Abdelrahman671" /><meta property="og:locale" content="en" /><meta name="description" content="A minimal, responsive, and powerful Jekyll theme for presenting professional writing." /><meta property="og:description" content="A minimal, responsive, and powerful Jekyll theme for presenting professional writing." /><link rel="canonical" href="https://abdelrahman671.github.io/posts/Squirrel/" /><meta property="og:url" content="https://abdelrahman671.github.io/posts/Squirrel/" /><meta property="og:site_name" content="Abdelrahman671" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-06T17:50:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Squirrel" /><meta name="twitter:site" content="@abu_shady816" /><meta name="twitter:creator" content="@abu_shady816" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Abdelrahman671","url":"https://github.com/abdelrahman671/"},"dateModified":"2022-10-06T17:57:58+02:00","datePublished":"2022-10-06T17:50:00+02:00","description":"A minimal, responsive, and powerful Jekyll theme for presenting professional writing.","headline":"Squirrel","mainEntityOfPage":{"@type":"WebPage","@id":"https://abdelrahman671.github.io/posts/Squirrel/"},"url":"https://abdelrahman671.github.io/posts/Squirrel/"}</script><title>Squirrel | Abdelrahman671</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Abdelrahman671"><meta name="application-name" content="Abdelrahman671"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://opgg-static.akamaized.net/images/profile_icons/profileIcon5265.jpg?image=q_auto&image=q_auto,f_webp,w_48&v=1662111457535" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Abdelrahman671</a></div><div class="site-subtitle font-italic">CSE Student, Cyber Security Enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/abdelrahman671" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/abu_shady816" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['abdelrahmanabushady816','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/abdelrahman-alaa-1a86131a1/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Squirrel</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Squirrel</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1665071400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 6, 2022 </em> </span> <span> Updated <em class="" data-ts="1665071878" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 6, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/abdelrahman671/">Abdelrahman671</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="245 words"> <em>1 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="/assets/img/squirrel/w1.png" alt="challenge image" data-proofer-ignore></p><h2 id="step-1"><span class="mr-2">Step 1:</span><a href="#step-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After downloading the zip file and extracting it. we will find an image jpg file.</p><p>By passing the image file to strings command <code class="language-plaintext highlighter-rouge">strings squirrel.jpg | less</code>, we will observe a link to download another file.</p><p><img data-src="/assets/img/squirrel/w2.png" alt="mediafire link" data-proofer-ignore></p><h2 id="step-2"><span class="mr-2">Step 2:</span><a href="#step-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After downloading the zip file, we will find that it is protected by a password.</p><p><img data-src="/assets/img/squirrel/w3.png" alt="zip file with protected password" data-proofer-ignore></p><p>So let’s use <code class="language-plaintext highlighter-rouge">zip2john tool</code> and see if we are able to crack the password or not.</p><p>Getting hash of zip file :</p><p><img data-src="/assets/img/squirrel/w4.png" alt="get hash of zip file using zip2john" data-proofer-ignore></p><p>Running rockyou.txt wordlist to crack the password hash</p><p><img data-src="/assets/img/squirrel/w5.png" alt="john usage using wordlist" data-proofer-ignore></p><p>Since I have cracked this hash before so let’s use the <code class="language-plaintext highlighter-rouge">--show</code> option to display the password.</p><p><img data-src="/assets/img/squirrel/w6.png" alt="password of zip file" data-proofer-ignore></p><p>Zip file password : <code class="language-plaintext highlighter-rouge">squirrel07</code></p><h2 id="step-3"><span class="mr-2">Step 3:</span><a href="#step-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Passing <code class="language-plaintext highlighter-rouge">EVIL file</code> to <code class="language-plaintext highlighter-rouge">file command</code>, we will observe that it can’t recognize the type of it’s data.</p><p>So I decided to check the hexdump of this file in order to check the magic bytes of it.</p><p>using this command : <code class="language-plaintext highlighter-rouge">xxd -g 1 EVIL | less</code></p><p><img data-src="/assets/img/squirrel/w7.png" alt="magic bytes of EVIL file" data-proofer-ignore></p><p>We will find that the first 4 bytes are corrupted according to the JFIF file signature.</p><p><img data-src="/assets/img/squirrel/w8.png" alt="file signature of jfif file" data-proofer-ignore></p><p>Modifying these bytes by any hexeditor tool, I have used <code class="language-plaintext highlighter-rouge">ghex</code> then changed the file extension to <code class="language-plaintext highlighter-rouge">EVIL.jfif</code>.</p><h2 id="step-4"><span class="mr-2">Step 4:</span><a href="#step-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Opening the image file after we have modified the corrupted bytes and changed its extension, we will see a text in top-right corner.</p><p><img data-src="/assets/img/squirrel/w9.png" alt="jfif image" data-proofer-ignore></p><p>Copying this text and using <a href="https://gchq.github.io/CyberChef/">CyberChef</a>, It will detect that it is a base32 encoding text.</p><p><img data-src="/assets/img/squirrel/w10.png" alt="cyberchef decoding base32 text" data-proofer-ignore></p><p>Decoding the text from base32 and we will find the flag : <code class="language-plaintext highlighter-rouge">flag{Ev1l_S9uirr3lz}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cybertalents-writeup/'>CyberTalents Writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >Writeup</a> <a href="/tags/dfir/" class="post-tag no-text-decoration" >DFIR</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Squirrel+-+Abdelrahman671&url=https%3A%2F%2Fabdelrahman671.github.io%2Fposts%2FSquirrel%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Squirrel+-+Abdelrahman671&u=https%3A%2F%2Fabdelrahman671.github.io%2Fposts%2FSquirrel%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fabdelrahman671.github.io%2Fposts%2FSquirrel%2F&text=Squirrel+-+Abdelrahman671" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Squirrel/">Squirrel</a><li><a href="/posts/Hidden-In-Plain/">Hidden In Plain</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/network-security/">Network Security</a> <a class="post-tag" href="/tags/writeup/">Writeup</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Hidden-In-Plain/"><div class="card-body"> <em class="small" data-ts="1663889400" data-df="ll" > Sep 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hidden In Plain</h3><div class="text-muted small"><p> Step 1: After downloading the zip file and extracting it. we will find three pcap files and analysing them by using wireshark tool. First thing, let’s check what procotols do they have via Stat...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Hidden-In-Plain/" class="btn btn-outline-primary" prompt="Older"><p>Hidden In Plain</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/abdelrahman671">Abdelrahman671</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/network-security/">Network Security</a> <a class="post-tag" href="/tags/writeup/">Writeup</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
